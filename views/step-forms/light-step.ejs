<form id="lightStepForm" onsubmit="event.preventDefault(); saveStep(new FormData(this));">
    <input type="hidden" name="type" value="light">
    <input type="hidden" name="stepIndex" value="<%= stepIndex %>">
    
    <div>
        <label for="part_id">Light:</label>
        <select name="part_id" required>
            <% lightParts.forEach(function(part) { %>
                <option value="<%= part.id %>"><%= part.name %></option>
            <% }); %>
        </select>
    </div>
    
    <div>
        <label for="state">State:</label>
        <select name="state" required>
            <option value="on">On</option>
            <option value="off">Off</option>
        </select>
    </div>
    
    <div>
        <label for="duration">Duration (ms):</label>
        <input type="number" name="duration" min="0" required>
    </div>
    
    <div>
        <label for="concurrent">Concurrent:</label>
        <input type="checkbox" name="concurrent">
    </div>
    
    <div>
        <label for="description">Description:</label>
        <input type="text" name="description" required>
    </div>
    
    <button type="submit">Save Step</button>
    <button type="button" onclick="$('#stepFormContainer').hide();">Cancel</button>
</form>

<button type="button" onclick="testLight()">Test Light</button>

<script>
    function testLight() {
        const formData = new FormData(document.getElementById('lightStepForm'));
        $.post('/parts/test-light', formData)
            .done(function(response) {
                alert('Light test successful');
            })
            .fail(function(xhr, status, error) {
                alert('Error testing light: ' + error);
            });
    }
</script>
