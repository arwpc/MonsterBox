<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        #log-box {
            border: 1px solid #00ff00;
            padding: 10px;
            height: 300px;
            overflow-y: scroll;
            background-color: #001100;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            margin-bottom: 20px;
        }
        #controls {
            margin-top: 20px;
        }
        #controls button {
            margin-right: 10px;
        }
        .step {
            margin-bottom: 10px;
            padding: 5px;
            border: 1px solid #00ff00;
        }
        .current-step {
            background-color: #003300;
        }
        .error-message {
            color: #ff0000;
        }
        #debug-info {
            background-color: #ffffcc;
            border: 1px solid #ffcc00;
            padding: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1><%= title %></h1>
    <h2><%= scene.scene_name %></h2>
    
    <div id="scene-overview">
        <h3>Scene Steps:</h3>
        <% if (scene && scene.steps && scene.steps.length > 0) { %>
            <% scene.steps.forEach((step, index) => { %>
                <div class="step" id="step-<%= index %>">
                    <strong>Step <%= index + 1 %>:</strong> <%= step.name %> (<%= step.type %>)
                </div>
            <% }); %>
        <% } else { %>
            <p>No steps found for this scene.</p>
        <% } %>
    </div>
    
    <div id="log-box"></div>
    
    <div id="controls">
        <button id="backward-btn">Backward</button>
        <button id="run-btn">Run</button>
        <button id="forward-btn">Forward</button>
        <button id="stop-btn" disabled>Stop All Steps</button>
    </div>
    
    <a href="/scenes?characterId=<%= characterId %>" class="button">Back to Scenes</a>

    <div id="debug-info">
        <h3>Debug Information:</h3>
        <pre id="scene-data"></pre>
        <p>Character ID: <span id="character-id"></span></p>
    </div>

    <script>
        const sceneData = <%- JSON.stringify(scene) %>;
        const characterId = "<%= characterId %>";
    </script>
    <script>
        // Basic diagnostic script
        console.log("Inline script running");
        if (typeof jQuery !== 'undefined') {
            console.log("jQuery is loaded, version:", jQuery.fn.jquery);
        } else {
            console.log("jQuery is not loaded");
        }
        console.log("Scene data:", sceneData);
        console.log("Character ID:", characterId);

        // Display debug information
        document.getElementById('scene-data').textContent = JSON.stringify(sceneData, null, 2);
        document.getElementById('character-id').textContent = characterId;

        // Add click event listeners to buttons
        document.querySelectorAll('#controls button').forEach(button => {
            button.addEventListener('click', function() {
                console.log(this.id + " clicked");
            });
        });
    </script>
    <script src="/scripts/scene-player.js"></script>
</body>
</html>